{
    "Mappings": {
        "MapFindAZLetter": {
            "letter": {
                "0": "a",
                "1": "b",
                "2": "c",
                "3": "d",
                "4": "e"
            }
        }
    },
    "Parameters": {
        "ParamProject": {
            "Description": "Project name to tag resources with",
            "Type": "String",
            "MinLength": "1",
            "MaxLength": "16",
            "AllowedPattern": "[a-z]*",
            "Default": "hurried",
            "ConstraintDescription": "any alphabetic string (1-16) characters in length"
        },
        "ParamVpcCidr": {
            "Description": "The CIDR block for the entire VPC network",
            "Type": "String",
            "AllowedPattern": "(\\d{1,3})\\.(\\d{1,3})\\.(\\d{1,3})\\.(\\d{1,3})/(\\d{1,2})",
            "Default": "172.27.0.0/16",
            "ConstraintDescription": "must be an IPv4 dotted quad plus slash plus network bit length in CIDR format"
        },
        "ParamSubnetAExt": {
            "Description": "The CIDR block for VPC SubnetA External segment",
            "Type": "String",
            "AllowedPattern": "(\\d{1,3})\\.(\\d{1,3})\\.(\\d{1,3})\\.(\\d{1,3})/(\\d{1,2})",
            "Default": "172.27.0.0/24",
            "ConstraintDescription": "must be an IPv4 dotted quad plus slash plus network bit length in CIDR format"
        },
        "ParamSubnetA": {
            "Description": "The CIDR block for VPC SubnetAInt segment",
            "Type": "String",
            "AllowedPattern": "(\\d{1,3})\\.(\\d{1,3})\\.(\\d{1,3})\\.(\\d{1,3})/(\\d{1,2})",
            "Default": "172.27.1.0/24",
            "ConstraintDescription": "must be an IPv4 dotted quad plus slash plus network bit length in CIDR format"
        },
        "ParamSubnetB": {
            "Description": "The CIDR block for VPC SubnetBInt segment",
            "Type": "String",
            "AllowedPattern": "(\\d{1,3})\\.(\\d{1,3})\\.(\\d{1,3})\\.(\\d{1,3})/(\\d{1,2})",
            "Default": "172.27.2.0/24",
            "ConstraintDescription": "must be an IPv4 dotted quad plus slash plus network bit length in CIDR format"
        },
        "ParamSubnetC": {
            "Description": "The CIDR block for VPC SubnetCInt segment",
            "Type": "String",
            "AllowedPattern": "(\\d{1,3})\\.(\\d{1,3})\\.(\\d{1,3})\\.(\\d{1,3})/(\\d{1,2})",
            "Default": "172.27.3.0/24",
            "ConstraintDescription": "must be an IPv4 dotted quad plus slash plus network bit length in CIDR format"
        },
        "ParamSubnetD": {
            "Description": "The CIDR block for VPC SubnetDInt segment",
            "Type": "String",
            "AllowedPattern": "(\\d{1,3})\\.(\\d{1,3})\\.(\\d{1,3})\\.(\\d{1,3})/(\\d{1,2})",
            "Default": "172.27.4.0/24",
            "ConstraintDescription": "must be an IPv4 dotted quad plus slash plus network bit length in CIDR format"
        }
    },
    "AWSTemplateFormatVersion": "2010-09-09",
    "Metadata": {
        "AWS::CloudFormation::Designer": {
            "52b82f9f-d6e6-4158-ac59-c062e7b69372": {
                "size": {
                    "width": 1180,
                    "height": 730
                },
                "position": {
                    "x": 20,
                    "y": 30
                },
                "z": 1,
                "embeds": [
                    "7cbe8527-076d-42c6-ae2c-dc986db36a7b",
                    "8f640c38-33b7-4e3d-a90e-2ea5a3f4947f",
                    "b8e2dd26-53a1-40c5-ad8a-edbe7b45aa2b",
                    "9b1102ca-d623-4cff-bddc-bf389ce794fd",
                    "7e02d9f7-ca36-470c-9ce3-694b8e11850c",
                    "70b196d1-d8bb-4567-ad3d-e41f5450b7d0",
                    "c03cf994-e9e7-4c9e-96fb-b5359586c828",
                    "72fdfd85-afc2-4e7c-a8b2-d06d2d720950"
                ]
            },
            "c03cf994-e9e7-4c9e-96fb-b5359586c828": {
                "size": {
                    "width": 150,
                    "height": 150
                },
                "position": {
                    "x": 460,
                    "y": 290
                },
                "z": 2,
                "parent": "52b82f9f-d6e6-4158-ac59-c062e7b69372",
                "embeds": []
            },
            "70b196d1-d8bb-4567-ad3d-e41f5450b7d0": {
                "size": {
                    "width": 150,
                    "height": 150
                },
                "position": {
                    "x": 290,
                    "y": 290
                },
                "z": 2,
                "parent": "52b82f9f-d6e6-4158-ac59-c062e7b69372",
                "embeds": [],
                "isrelatedto": [
                    "70b196d1-d8bb-4567-ad3d-e41f5450b7d0"
                ]
            },
            "7e02d9f7-ca36-470c-9ce3-694b8e11850c": {
                "size": {
                    "width": 150,
                    "height": 150
                },
                "position": {
                    "x": 630,
                    "y": 290
                },
                "z": 2,
                "parent": "52b82f9f-d6e6-4158-ac59-c062e7b69372",
                "embeds": []
            },
            "9b1102ca-d623-4cff-bddc-bf389ce794fd": {
                "size": {
                    "width": 150,
                    "height": 150
                },
                "position": {
                    "x": 800,
                    "y": 290
                },
                "z": 2,
                "parent": "52b82f9f-d6e6-4158-ac59-c062e7b69372",
                "embeds": []
            },
            "72fdfd85-afc2-4e7c-a8b2-d06d2d720950": {
                "size": {
                    "width": 60,
                    "height": 60
                },
                "position": {
                    "x": 220,
                    "y": 90
                },
                "z": 2,
                "parent": "52b82f9f-d6e6-4158-ac59-c062e7b69372",
                "embeds": [],
                "isconnectedto": [
                    "70b196d1-d8bb-4567-ad3d-e41f5450b7d0",
                    "c03cf994-e9e7-4c9e-96fb-b5359586c828"
                ],
                "dependson": [
                    "c03cf994-e9e7-4c9e-96fb-b5359586c828",
                    "70b196d1-d8bb-4567-ad3d-e41f5450b7d0",
                    "7cbe8527-076d-42c6-ae2c-dc986db36a7b"
                ]
            },
            "7cbe8527-076d-42c6-ae2c-dc986db36a7b": {
                "size": {
                    "width": 60,
                    "height": 60
                },
                "position": {
                    "x": 50,
                    "y": 90
                },
                "z": 2,
                "parent": "52b82f9f-d6e6-4158-ac59-c062e7b69372",
                "embeds": []
            },
            "866e4215-1897-4cd2-a4a1-8d5b96f206a9": {
                "source": {
                    "id": "72fdfd85-afc2-4e7c-a8b2-d06d2d720950"
                },
                "target": {
                    "id": "70b196d1-d8bb-4567-ad3d-e41f5450b7d0"
                },
                "z": 3
            },
            "494da941-e27f-4bb4-bcba-2ac8e661a894": {
                "source": {
                    "id": "72fdfd85-afc2-4e7c-a8b2-d06d2d720950"
                },
                "target": {
                    "id": "c03cf994-e9e7-4c9e-96fb-b5359586c828"
                },
                "z": 4
            },
            "1daf9b43-de2f-4d4b-b753-41d17af018c8": {
                "source": {
                    "id": "72fdfd85-afc2-4e7c-a8b2-d06d2d720950"
                },
                "target": {
                    "id": "7e02d9f7-ca36-470c-9ce3-694b8e11850c"
                },
                "z": 5
            },
            "7b6ad4f4-6f07-4099-af5a-7889b6b72c41": {
                "source": {
                    "id": "72fdfd85-afc2-4e7c-a8b2-d06d2d720950"
                },
                "target": {
                    "id": "9b1102ca-d623-4cff-bddc-bf389ce794fd"
                },
                "z": 6
            },
            "f1f39afb-dbfa-48fc-9fa2-2abbd90e9991": {
                "source": {
                    "id": "72fdfd85-afc2-4e7c-a8b2-d06d2d720950"
                },
                "target": {
                    "id": "c03cf994-e9e7-4c9e-96fb-b5359586c828"
                },
                "z": 3
            },
            "b4221cd2-6667-4667-9880-9ee114beffb7": {
                "source": {
                    "id": "72fdfd85-afc2-4e7c-a8b2-d06d2d720950"
                },
                "target": {
                    "id": "70b196d1-d8bb-4567-ad3d-e41f5450b7d0"
                },
                "z": 4
            },
            "de75b6f3-963a-4d11-bede-9c5ff56c58f3": {
                "source": {
                    "id": "72fdfd85-afc2-4e7c-a8b2-d06d2d720950"
                },
                "target": {
                    "id": "7cbe8527-076d-42c6-ae2c-dc986db36a7b"
                },
                "z": 3
            },
            "b8efad27-8965-44b1-9603-ff038b792f5b": {
                "source": {
                    "id": "7cbe8527-076d-42c6-ae2c-dc986db36a7b"
                },
                "target": {
                    "id": "52b82f9f-d6e6-4158-ac59-c062e7b69372"
                },
                "z": 2
            },
            "b8e2dd26-53a1-40c5-ad8a-edbe7b45aa2b": {
                "size": {
                    "width": 300,
                    "height": 170
                },
                "position": {
                    "x": 400,
                    "y": 90
                },
                "z": 2,
                "parent": "52b82f9f-d6e6-4158-ac59-c062e7b69372",
                "embeds": [
                    "0ae5bd2a-01fc-42de-8307-02c286faf3b7"
                ]
            },
            "0ae5bd2a-01fc-42de-8307-02c286faf3b7": {
                "size": {
                    "width": 60,
                    "height": 60
                },
                "position": {
                    "x": 420,
                    "y": 130
                },
                "z": 3,
                "parent": "b8e2dd26-53a1-40c5-ad8a-edbe7b45aa2b",
                "embeds": [],
                "references": [
                    "7cbe8527-076d-42c6-ae2c-dc986db36a7b"
                ]
            },
            "8f640c38-33b7-4e3d-a90e-2ea5a3f4947f": {
                "size": {
                    "width": 140,
                    "height": 140
                },
                "position": {
                    "x": 50,
                    "y": 300
                },
                "z": 2,
                "parent": "52b82f9f-d6e6-4158-ac59-c062e7b69372",
                "embeds": []
            }
        }
    },
    "Resources": {
        "VPC": {
            "Type": "AWS::EC2::VPC",
            "Properties": {
                "CidrBlock": {
                    "Ref": "ParamVpcCidr"
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": {
                            "Fn::Join": [
                                "-",
                                [
                                    {
                                        "Ref": "ParamProject"
                                    },
                                    "vpc"
                                ]
                            ]
                        }
                    }
                ]
            },
            "Metadata": {
                "AWS::CloudFormation::Designer": {
                    "id": "52b82f9f-d6e6-4158-ac59-c062e7b69372"
                }
            }
        },
        "SubnetBInt": {
            "Type": "AWS::EC2::Subnet",
            "Properties": {
                "VpcId": {
                    "Ref": "VPC"
                },
                "CidrBlock": {
                    "Ref": "ParamSubnetB"
                },
                "AvailabilityZone": {
                    "Fn::Select": [
                        1,
                        {
                            "Fn::GetAZs": ""
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": {
                            "Fn::Join": [
                                "-",
                                [
                                    {
                                        "Ref": "ParamProject"
                                    },
                                    "sn",
                                    {
                                        "Fn::FindInMap": [
                                            "MapFindAZLetter",
                                            "letter",
                                            "1"
                                        ]
                                    },
                                    "int"
                                ]
                            ]
                        }
                    }
                ]
            },
            "Metadata": {
                "AWS::CloudFormation::Designer": {
                    "id": "c03cf994-e9e7-4c9e-96fb-b5359586c828"
                }
            }
        },
        "SubnetAInt": {
            "Type": "AWS::EC2::Subnet",
            "Properties": {
                "VpcId": {
                    "Ref": "VPC"
                },
                "CidrBlock": {
                    "Ref": "ParamSubnetA"
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": {
                            "Fn::Join": [
                                "-",
                                [
                                    {
                                        "Ref": "ParamProject"
                                    },
                                    "sn",
                                    {
                                        "Fn::FindInMap": [
                                            "MapFindAZLetter",
                                            "letter",
                                            "0"
                                        ]
                                    },
                                    "int"
                                ]
                            ]
                        }
                    }
                ],
                "AvailabilityZone": {
                    "Fn::Select": [
                        0,
                        {
                            "Fn::GetAZs": ""
                        }
                    ]
                }
            },
            "Metadata": {
                "AWS::CloudFormation::Designer": {
                    "id": "70b196d1-d8bb-4567-ad3d-e41f5450b7d0"
                }
            }
        },
        "SubnetCInt": {
            "Type": "AWS::EC2::Subnet",
            "Properties": {
                "VpcId": {
                    "Ref": "VPC"
                },
                "CidrBlock": {
                    "Ref": "ParamSubnetC"
                },
                "AvailabilityZone": {
                    "Fn::Select": [
                        2,
                        {
                            "Fn::GetAZs": ""
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": {
                            "Fn::Join": [
                                "-",
                                [
                                    {
                                        "Ref": "ParamProject"
                                    },
                                    "sn",
                                    {
                                        "Fn::FindInMap": [
                                            "MapFindAZLetter",
                                            "letter",
                                            "2"
                                        ]
                                    },
                                    "int"
                                ]
                            ]
                        }
                    }
                ]
            },
            "Metadata": {
                "AWS::CloudFormation::Designer": {
                    "id": "7e02d9f7-ca36-470c-9ce3-694b8e11850c"
                }
            }
        },
        "SubnetDInt": {
            "Type": "AWS::EC2::Subnet",
            "Properties": {
                "VpcId": {
                    "Ref": "VPC"
                },
                "CidrBlock": {
                    "Ref": "ParamSubnetD"
                },
                "AvailabilityZone": {
                    "Fn::Select": [
                        3,
                        {
                            "Fn::GetAZs": ""
                        }
                    ]
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": {
                            "Fn::Join": [
                                "-",
                                [
                                    {
                                        "Ref": "ParamProject"
                                    },
                                    "sn",
                                    {
                                        "Fn::FindInMap": [
                                            "MapFindAZLetter",
                                            "letter",
                                            "3"
                                        ]
                                    },
                                    "int"
                                ]
                            ]
                        }
                    }
                ]
            },
            "Metadata": {
                "AWS::CloudFormation::Designer": {
                    "id": "9b1102ca-d623-4cff-bddc-bf389ce794fd"
                }
            }
        },
        "ElbA": {
            "Type": "AWS::ElasticLoadBalancing::LoadBalancer",
            "Properties": {
                "Subnets": [
                    {
                        "Ref": "SubnetAInt"
                    },
                    {
                        "Ref": "SubnetBInt"
                    }
                ],
                "LoadBalancerName": {
                    "Fn::Join": [
                        "-",
                        [
                            {
                                "Ref": "ParamProject"
                            },
                            "elb"
                        ]
                    ]
                },
                "Listeners": [
                    {
                        "LoadBalancerPort": "80",
                        "InstancePort": "80",
                        "Protocol": "HTTP"
                    }
                ]
            },
            "Metadata": {
                "AWS::CloudFormation::Designer": {
                    "id": "72fdfd85-afc2-4e7c-a8b2-d06d2d720950"
                }
            },
            "DependsOn": [
                "SubnetBInt",
                "SubnetAInt",
                "InternetGateway"
            ]
        },
        "InternetGatewayAttachment": {
            "Type": "AWS::EC2::VPCGatewayAttachment",
            "Properties": {
                "VpcId": {
                    "Ref": "VPC"
                },
                "InternetGatewayId": {
                    "Ref": "InternetGateway"
                }
            },
            "Metadata": {
                "AWS::CloudFormation::Designer": {
                    "id": "b8efad27-8965-44b1-9603-ff038b792f5b"
                }
            }
        },
        "InternetGateway": {
            "Type": "AWS::EC2::InternetGateway",
            "Properties": {
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": {
                            "Fn::Join": [
                                "-",
                                [
                                    {
                                        "Ref": "ParamProject"
                                    },
                                    "igw"
                                ]
                            ]
                        }
                    }
                ]
            },
            "Metadata": {
                "AWS::CloudFormation::Designer": {
                    "id": "7cbe8527-076d-42c6-ae2c-dc986db36a7b"
                }
            }
        },
        "RouteTablePublic": {
            "Type": "AWS::EC2::RouteTable",
            "Properties": {
                "VpcId": {
                    "Ref": "VPC"
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": {
                            "Fn::Join": [
                                "-",
                                [
                                    {
                                        "Ref": "ParamProject"
                                    },
                                    "public",
                                    "rt"
                                ]
                            ]
                        }
                    }
                ]
            },
            "Metadata": {
                "AWS::CloudFormation::Designer": {
                    "id": "b8e2dd26-53a1-40c5-ad8a-edbe7b45aa2b"
                }
            }
        },
        "RoutePublic": {
            "Type": "AWS::EC2::Route",
            "Properties": {
                "DestinationCidrBlock": "0.0.0.0/0",
                "RouteTableId": {
                    "Ref": "RouteTablePublic"
                },
                "GatewayId": {
                    "Ref": "InternetGateway"
                }
            },
            "Metadata": {
                "AWS::CloudFormation::Designer": {
                    "id": "0ae5bd2a-01fc-42de-8307-02c286faf3b7"
                }
            }
        },
        "SubnetAExt": {
            "Type": "AWS::EC2::Subnet",
            "Properties": {
                "VpcId": {
                    "Ref": "VPC"
                },
                "CidrBlock": {
                    "Ref": "ParamSubnetAExt"
                },
                "Tags": [
                    {
                        "Key": "Name",
                        "Value": {
                            "Fn::Join": [
                                "-",
                                [
                                    {
                                        "Ref": "ParamProject"
                                    },
                                    "sn",
                                    {
                                        "Fn::FindInMap": [
                                            "MapFindAZLetter",
                                            "letter",
                                            "0"
                                        ]
                                    },
                                    "ext"
                                ]
                            ]
                        }
                    }
                ],
                "AvailabilityZone": {
                    "Fn::Select": [
                        0,
                        {
                            "Fn::GetAZs": ""
                        }
                    ]
                }
            },
            "Metadata": {
                "AWS::CloudFormation::Designer": {
                    "id": "8f640c38-33b7-4e3d-a90e-2ea5a3f4947f"
                }
            }
        }
    }
}